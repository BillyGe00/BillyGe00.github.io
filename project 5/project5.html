<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Project 5</title>
        <link rel="stylesheet" href="../style/project5_style.css">
    </head>
</html>

<body>
    <div class="main">
        <h1>Project 5</h1>

        <h2>Project Description Part A (The Power of Diffusion Models)</h2>
        <h4>
            In part A of this project, I play around with DeepFloyd pre-trained diffusion model, including implementing diffusion sampling loops and using them for other tasks such as inpainting and creating optical illusions. DeepFloyd was trained as a text-to-image model, which takes text prompts as input and outputs images that are aligned with the text.
            <br><br>
            The instruction for part A can be found <a href="https://cal-cs180.github.io/fa24/hw/proj5/parta.html" target="_blank">here</a>.
        </h4>

        <h3>PartA 0 Sampling from the Model</h3>
        <h4>
            To start off, our pre-trained DeepFloyd diffusion model contains two stages. The first stage produces images of size 64 * 64 and the second stage takes the outputs of the first stage and generates images of size 256 * 256.
            <br><br>
            In each stage of the pre-trained model, I can set the num_inference_steps, which controls the number of denoising iterations. Below are sample output image results of differing num_inference_steps values. As shown, it is obvious that the quality of output images are higher as num_inference_steps increases. It is most notable in two aspects: the diversity of colors and the details. For example, with the text prompt of “an oil painting of a snowy mountain village”, the colors of the output images are significantly more diverse and bright, which is reflective of oil painting impressions. In addition, with the text prompt of “a rocket ship”, the cloud looks much more real when num_inference_steps = 100 compared to when num_inference_steps = 10.
            <br><br>
            The random seed I set is 180.
        </h4>
        <hr>
        <div class="parta_0">
            <div class="take-place-as-an-image">
                <p>(stage1, stage2) = (10, 10)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_village_10_10.png" height="300">
                <p>an oil painting of<br>a snowy mountain village</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_manhat_10_10.png" height="300">
                <p>a man wearing a hat</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_rocket_10_10.png" height="300">
                <p>a rocket ship</p>
            </div>
            <hr>
            <div class="take-place-as-an-image">
                <p>(stage1, stage2) = (50, 50)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_village_50_50.png" height="300">
                <p>an oil painting of<br>a snowy mountain village</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_manhat_50_50.png" height="300">
                <p>a man wearing a hat</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_rocket_50_50.png" height="300">
                <p>a rocket ship</p>
            </div>
            <hr>
            <div class="take-place-as-an-image">
                <p>(stage1, stage2) = (100, 100)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_village_100_100.png" height="300">
                <p>an oil painting of<br>a snowy mountain village</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_manhat_100_100.png" height="300">
                <p>a man wearing a hat</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta0/parta0_rocket_100_100.png" height="300">
                <p>a rocket ship</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.1 Implementing the Forward Process</h3>
        <h4>
            In order to play around with the denoising pre-trained diffusion model, we first need a process to add noise to clean images. It is called the forward process. The key parameter controlling how much noise to add is t, which is a value between 0 and 999. The larger the t value, the closer the image is to white noise.
            <br><br>
            Below are three noisy images as output results of the forward process. They have t values equal to 250, 500, 750 respectively.
        </h4>
        <hr>
        <div class="parta_1.1">
            <div class="individual-image">
                <img src="input_data/campanile.png" height="275">
                <p>Campanile Original</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.1_campanile_250.png" height="275">
                <p>Noisy Campanile (t = 250)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.1_campanile_500.png" height="275">
                <p>Noisy Campanile (t = 500)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.1_campanile_750.png" height="275">
                <p>Noisy Campanile (t = 750)</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.2 Classical Denoising</h3>
        <h4>In this part, we denoise the three noisy images from the previous part using classical gaussian blur method. Though trying different values of kernel size and sigma parameters, I am unable to obtain good denoising results.</h4>
        <hr>
        <div class="parta_1.2">
            <div class="take-place-as-an-image">
                <p>Gaussian Blur Denoising</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.2_campanile_250.png" height="300">
                <p>Denoised Campanile (t = 250)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.2_campanile_500.png" height="300">
                <p>Denoised Campanile (t = 500)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.2_campanile_750.png" height="300">
                <p>Denoised Campanile (t = 750)</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.3 One-Step Denoising</h3>
        <h4>Rather than an iterative denoising process (which is essential in diffusion models), in this part we use one-step denoising. We do this by estimating noise using the pre-trained model, then reverse the process from the forward process where we add noise to clean images. As shown below, one-step denoising performs much better than classical gaussian blur denoising.</h4>
        <hr>
        <div class="parta_1.3">
            <div class="take-place-as-an-image">
                <p>One-Step Denoising</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.3_campanile_250.png" height="300">
                <p>Denoised Campanile (t = 250)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.3_campanile_500.png" height="300">
                <p>Denoised Campanile (t = 500)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.3_campanile_750.png" height="300">
                <p>Denoised Campanile (t = 750)</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.4 Iterative Denoising</h3>
        <h4>
            In this part it is finally time to implement iterative denoising using the same pre-trained noise estimator from one-step denoising. Rather than doing iterative denoising of every t value (which is between 0 and 999), there is a shortcut to denoise images at t intervals of 30 (recommended by the instructor).
            <br><br>
            The example below first adds noise to the clean original campanile image to t = 690. Then it iteratively denoises the image at t steps of 30. At every 150 intervals of t, I also showed the noisy campanile images.
            <br><br>
            Furthermore, we can compare the denoising performances between classical gaussian blur, one-step, and iterative approaches. The gaussian method is easily the worst, the one-step method does not contain details, whereas the iterative method is the winner of three.
        </h4>
        <hr>
        <div class="parta_1.4">
            <div class="take-place-as-an-image">
                <p>Iterative Denoising from t = 690</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.4_campanile_iterative_90.png" height="150">
                <p>Noisy Campanile<br>(t = 90)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.4_campanile_iterative_240.png" height="150">
                <p>Noisy Campanile<br>(t = 240)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.4_campanile_iterative_390.png" height="150">
                <p>Noisy Campanile<br>(t = 390)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.4_campanile_iterative_540.png" height="150">
                <p>Noisy Campanile<br>(t = 540)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.4_campanile_iterative_690.png" height="150">
                <p>Noisy Campanile<br>(t = 690)</p>
            </div>
            <hr>
            <div class="take-place-as-an-image">
                <p></p>
            </div>
            <div class="individual-image">
                <img src="input_data/campanile.png" height="150">
                <p>Campanile<br>Original</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.4_campanile_iterative_0.png" height="150">
                <p>Denoised Campanile<br>(Iterative Approach)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.4_campanile_one_step.png" height="150">
                <p>Denoised Campanile<br>(One-Step Approach)</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.4_campanile_gaussain.png" height="150">
                <p>Denoised Campanile<br>(Guassian Blur Approach)</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.5 Diffusion Model Sampling</h3>
        <h4>Changing our mindset a bit, if we denoise from a completely white noise image, we are able to use the same mechanism as iterative denoising to generate completely new images given a text prompt. Below are five sample output results. The input text prompt is “a high quality photo”.</h4>
        <hr>
        <div class="parta_1.5">
            <div class="individual-image">
                <img src="output_data/parta1/parta1.5_sample1.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.5_sample2.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.5_sample3.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.5_sample4.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.5_sample5.png" height="200">
            </div>
        </div>
        <hr>

        <h3>PartA 1.6 Classifier-Free Guidance (CFG)</h3>
        <h4>
            Although sample output images from the previous part are generative, their quality is not high (lack of colors and details), indicating that we need some changes to the mechanism to make our model follow more closely to the input text prompt. This mechanism change is called classifier-free guidance (CFG).
            <br><br>
            Basically, in CFG, instead of inputting a single text prompt, we now input two text prompts, the first being the same as whatever our actual text prompt is, and the second being an empty string. We then estimate noise from both text prompts in each iteration. Using the combination of the two noise estimates, we then denoise the noisy image.
            <br><br>
            Below are five sample output results from CFG, which indeed have higher quality compared to sample output results from the previous part.
        </h4>
        <hr>
        <div class="parta_1.6">
            <div class="individual-image">
                <img src="output_data/parta1/parta1.6_sample1.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.6_sample2.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.6_sample3.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.6_sample4.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.6_sample5.png" height="200">
            </div>
        </div>
        <hr>

        <h3>PartA 1.7 Image-to-image Translation</h3>
        <h4>
            In partA 1.4, we take a real image, add noise to it, and then denoise. This effectively allows us to make edits to existing images. The more noise we add, the larger the edit will be. This works because in order to denoise an image, the diffusion model must to some extent "hallucinate" new things -- the model has to be "creative." Another way to think about it is that the denoising process "forces" a noisy image back onto the manifold of natural images.
            <br><br>
            In this part, we add different amounts of noise to a clean image and then denoise them. We want to see that as we add less noise, the denoised output image shall look closer to the original clean image.
            <br><br>
            Here, i_start is a different parameter that represents the same meaning as parameter t, as explained in partA 1.1. Larger i_start values correspond to lower t values, or less noise added to the clean input image.
        </h4>
        <hr>
        <div class="parta_1.7">
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_campanile_1.png" height="125">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_campanile_3.png" height="125">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_campanile_5.png" height="125">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_campanile_7.png" height="125">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_campanile_10.png" height="125">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_campanile_20.png" height="125">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="input_data/campanile.png" height="125">
                <p>Campanile Original</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_elephant_1.png" height="125">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_elephant_3.png" height="125">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_elephant_5.png" height="125">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_elephant_7.png" height="125">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_elephant_10.png" height="125">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_elephant_20.png" height="125">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="input_data/elephant.png" height="125">
                <p>Elephant Original</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_plane_1.png" height="125">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_plane_3.png" height="125">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_plane_5.png" height="125">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_plane_7.png" height="125">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_plane_10.png" height="125">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7_plane_20.png" height="125">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="input_data/plane.png" height="125">
                <p>Plane Original</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.7.1 Editing Hand-Drawn and Web Images</h3>
        <h4>This part is a real world application example of partA 1.7, where we want to generate a new image but we also want the new generated image to follow a certain structure from an input image. Depending on how much we want the output result image to be different from the input image, we can choose how much noise to add before the iterative denoising process.</h4>
        <hr>
        <div class="parta_1.7.1">
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_1.png" height="200">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_3.png" height="200">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_5.png" height="200">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_7.png" height="200">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_10.png" height="200">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_15.png" height="200">
                <p>i_start = 15</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_20.png" height="200">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_25.png" height="200">
                <p>i_start = 25</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_web_avocado_30.png" height="200">
                <p>i_start = 30</p>
            </div>
            <div class="individual-image">
                <img src="input_data/avocado.png" height="200">
                <p>Avocado Original</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_1.png" height="200">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_3.png" height="200">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_5.png" height="200">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_7.png" height="200">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_10.png" height="200">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_15.png" height="200">
                <p>i_start = 15</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_20.png" height="200">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_25.png" height="200">
                <p>i_start = 25</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_car_30.png" height="200">
                <p>i_start = 30</p>
            </div>
            <div class="individual-image">
                <img src="input_data/car_handdrawn.png" height="200">
                <p>Handdrawn Car Original</p>
            </div>
            <hr>            
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_1.png" height="200">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_3.png" height="200">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_5.png" height="200">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_7.png" height="200">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_10.png" height="200">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_15.png" height="200">
                <p>i_start = 15</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_20.png" height="200">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_25.png" height="200">
                <p>i_start = 25</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.1_handdrawn_suncloud_30.png" height="200">
                <p>i_start = 30</p>
            </div>
            <div class="individual-image">
                <img src="input_data/suncloud_handdrawn.png" height="200">
                <p>Handdrawn Suncloud Original</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.7.2 Inpainting</h3>
        <h4>Another fun application of generating a new image while preserving some parts of the input image is inpainting, or generating new image only in the masked region of the input image.</h4>
        <hr>
        <div class="parta_1.7.2">
            <div class="individual-image">
                <img src="input_data/campanile.png" height="300">
                <p>Campanile Original</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.2_mask_campanile.png" height="300">
                <p>Campanile Mask</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.2_campanile.png" height="300">
                <p>Campanile Inpainted</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="input_data/dog.png" height="300">
                <p>Dog Original</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.2_mask_dog.png" height="300">
                <p>Dog Mask</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.2_dog.png" height="300">
                <p>Dog Inpainted</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="input_data/painting.png" height="300">
                <p>Painting Original</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.2_mask_painting.png" height="300">
                <p>Painting Mask</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.2_painting.png" height="300">
                <p>Painting Inpainted</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.7.3 Text-Conditional Image-to-image Translation</h3>
        <h4>This part combines the previous part with partA 1.7.1, where we add different amounts of noise to the masked region in the input image before denoising them. Again, larger i_start values correspond to smaller t values, and thus we expect output results to look closer to the original input image.</h4>
        <hr>
        <div class="parta_1.7.3">
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_1.png" height="200">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_3.png" height="200">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_5.png" height="200">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_7.png" height="200">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_10.png" height="200">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_15.png" height="200">
                <p>i_start = 15</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_20.png" height="200">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_25.png" height="200">
                <p>i_start = 25</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_campanile_30.png" height="200">
                <p>i_start = 30</p>
            </div>
            <div class="individual-image">
                <img src="input_data/campanile.png" height="200">
                <p>Campanile Original</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_1.png" height="200">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_3.png" height="200">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_5.png" height="200">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_7.png" height="200">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_10.png" height="200">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_15.png" height="200">
                <p>i_start = 15</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_20.png" height="200">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_25.png" height="200">
                <p>i_start = 25</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_dog_30.png" height="200">
                <p>i_start = 30</p>
            </div>
            <div class="individual-image">
                <img src="input_data/dog.png" height="200">
                <p>Dog Original</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_1.png" height="200">
                <p>i_start = 1</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_3.png" height="200">
                <p>i_start = 3</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_5.png" height="200">
                <p>i_start = 5</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_7.png" height="200">
                <p>i_start = 7</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_10.png" height="200">
                <p>i_start = 10</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_15.png" height="200">
                <p>i_start = 15</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_20.png" height="200">
                <p>i_start = 20</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_25.png" height="200">
                <p>i_start = 25</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.7.3_painting_30.png" height="200">
                <p>i_start = 30</p>
            </div>
            <div class="individual-image">
                <img src="input_data/painting.png" height="200">
                <p>Painting Original</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.8 Visual Anagrams</h3>
        <h4>
            In this part we make small changes to our iterative denoising process to create a type of optical illusions: visual anagrams, where a single image tells two different stories through flipped and unflipped views.
            <br><br>
            The small change we make is inputting three text prompts, two of which are conditional text prompts each telling a story and the third text prompt is unconditional empty string that enhances the quality of output images. In each iteration, we use the pre-trained model to estimate noise from an unflipped conditional text prompt and a flipped conditional text prompt. We average the two noise estimates in the denoising process.
            <br><br>
            Check this out! It’s super cool!
        </h4>
        <hr>
        <div class="parta_1.8">
            <div class="individual-image">
                <img src="output_data/parta1/parta1.8_anagram_campfire_man_1.png" height="400">
                <p>an oil painting of an old man</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.8_anagram_campfire_man_2.png" height="400">
                <p>an oil painting of people around a campfire</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.8_anagram_dog_man_1.png" height="400">
                <p>a photo of a man</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.8_anagram_dog_man_2.png" height="400">
                <p>a photo of a dog</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.8_anagram_waterfall_village_1.png" height="400">
                <p>a lithograph of waterfalls</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.8_anagram_waterfall_village_2.png" height="400">
                <p>an oil painting of a snowy mountain village</p>
            </div>
        </div>
        <hr>

        <h3>PartA 1.9 Hyrbird Images</h3>
        <h4>
            In this part we make small changes to our iterative denoising process to create another type of optical illusions: hybrid images, where a single image looks like two different images when viewing from up close and far away. This is basically the same as project 2 part 2.2, except for that now we are generating new hybrid images using the pre-trained model.
            <br><br>
            The small change we make is in each iteration, we estimate noise from two conditional text prompts. We keep only the high frequency noise estimate of the image we want to see up close and the low frequency noise estimate of the image we want to see far away. We then add the two noise estimates.
        </h4>
        <hr>
        <div class="parta_1.9">
            <div class="individual-image">
                <img src="output_data/parta1/parta1.9_hybrid_dog_skull.png" height="350">
                <p>low frequency: a lithograph of a skull<br>high frequency: a photo of a dog</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.9_hybrid_rocket_pencil.png" height="350">
                <p>low frequency: a pencil<br>high frequency: a rocket ship</p>
            </div>
            <div class="individual-image">
                <img src="output_data/parta1/parta1.9_hybrid_waterfall_skull.png" height="350">
                <p>low frequency: a lithograph of a skull<br>high frequency: a lithograph of waterfalls</p>
            </div>
        </div>
        <hr>

        <h2>Project Description Part B (Diffusion Models from Scratch)</h2>
        <h4></h4>

        <h3>PartB 1 Training a Single-Step Denoising U-Net</h3>
        <h4></h4>
        <hr>
        <div class="partb_1.2">
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2_add_noise_sample1.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2_add_noise_sample2.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2_add_noise_sample3.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2_add_noise_sample4.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2_add_noise_sample5.png" height="200">
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2.1_training_loss.png" height="500">
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2.1_input.png" height="300">
            </div>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2.1_noisy.png" height="300">
            </div>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2.1_output_epoch1.png" height="300">
            </div>
            <div class="take-place-as-an-image">
                <p>Checkpoint Model Output 1st Epoch</p>
            </div>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2.1_output_epoch5.png" height="300">
            </div>
            <div class="take-place-as-an-image">
                <p>Checkpoint Model Output 5th Epoch</p>
            </div>
            <hr>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2.2_input.png" height="200">
            </div>
            <div class="individual-image">
                <img src="output_data/partb1/partb1.2.2_output.png" height="200">
            </div>
        </div>
        <hr>

        <h3>PartB 2 Training a Diffusion Model</h3>
        <h4></h4>

    </div>
</body>

